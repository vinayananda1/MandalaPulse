<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body {
        font-family: sans-serif;
        background-color: #f0fff0;
        text-align: center;
        padding-top: 80px;
        margin: 0;
      }
      h2 {
        color: #006600;
        margin-bottom: 20px;
      }
      #status {
        font-size: 16px;
        color: #444;
        margin-top: 10px;
      }
      #countdown {
        font-size: 24px;
        color: #003300;
        margin-top: 30px;
      }
    </style>
  </head>
  <body>
    <h2 id="greeting">üåº Welcome</h2>
    <p id="status">üïäÔ∏è Preparing MandalaPulse...</p>
    <p id="countdown">‚è≥ 5</p>

    <!-- üé∂ Ambient music -->
<audio autoplay loop>
  <source src="https://raw.githubusercontent.com/vinayananda1/MandalaPulse/main/02%20I%20Will%20Be%20Thine%20Always.mp3" type="audio/mpeg">
  Your browser does not support the audio element or the file is unavailable.
</audio>
 
    

    <script>
      const username = "<?= username ?>";

      window.addEventListener("DOMContentLoaded", () => {
        if (!username) {
          document.getElementById("greeting").textContent = "üõë No username provided.";
          document.getElementById("status").textContent = "";
          return;
        }

        google.script.run
          .withSuccessHandler(function(profile) {
            if (profile) {
              const fullName = profile.fullName || username;
              const title = profile.title ? profile.title + " " : "";
              const status = profile.status || "Unknown";

              document.getElementById("greeting").textContent = `üåº Welcome, ${title}${fullName}`;
              document.getElementById("status").textContent = `üïäÔ∏è Status: ${status}`;
            } else {
              document.getElementById("greeting").textContent = `üåº Welcome, ${username}`;
              document.getElementById("status").textContent = `üïäÔ∏è Profile not found`;
            }
          })
          .getProfile(username);

        // ‚è≥ Countdown and redirect
        let seconds = 5;
        const countdown = document.getElementById("countdown");
        const interval = setInterval(() => {
          seconds--;
          countdown.textContent = `‚è≥ ${seconds}`;
          if (seconds === 0) {
            clearInterval(interval);
            const baseUrl = "https://script.google.com/macros/s/YOUR_DEPLOYMENT_ID/exec";
            window.location.href = `${baseUrl}?view=q&user=${encodeURIComponent(username)}`;
          }
        }, 1000);
      });
    </script>
  </body>
</html>
