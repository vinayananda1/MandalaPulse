<script>
  // 🌼 Extract username from URL parameter
  const urlParams = new URLSearchParams(window.location.search);
  const email = urlParams.get("user");
  const password = "auto"; // symbolic password or backend lookup

  if (email) {
    // 🧘 Invoke backend validation
    google.script.run.withSuccessHandler(function(response) {
      if (response.status === "✅") {
        const role = response.role;
        const username = response.name;
        const code = Date.now(); // symbolic invocation code

        // 🌐 Redirect to admin.html with lineage
        window.location.href = `admin.html?username=${username}&role=${role}&code=${code}`;
      } else {
        alert("🛑 Auto-login failed: " + response.status);
      }
    }).validate(email, password);
  } else {
    alert("🛑 No user parameter found in URL");
  }
</script>
