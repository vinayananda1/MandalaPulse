<!DOCTYPE html>
<html>
<head>
  <title>üîÆ Admin Meeting Chamber</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f0f0f0; }
    input, button { margin-top: 10px; padding: 6px; }
  </style>
  <script>

    function submitMeeting() {
  const meetingData = {
    Date: document.getElementById("date").value.trim(),
    Time: document.getElementById("time").value.trim(),
    Topic: document.getElementById("topic").value.trim(),
    Host: document.getElementById("host").value.trim()
  };

  // Basic validation
  if (!meetingData.Date || !meetingData.Time || !meetingData.Topic || !meetingData.Host) {
    document.getElementById("status").innerText = "üõë Please fill all fields.";
    return;
  }

  google.script.run.withSuccessHandler(function(response) {
    document.getElementById("status").innerText = response;
  }).sendMeetingEmail(meetingData);
}
    function renderMeetings(meetings) {
      const table = document.getElementById("meetingTable");
      table.innerHTML = "<tr><th>Date</th><th>Time</th><th>Topic</th><th>Host</th><th>Actions</th></tr>";

      meetings.forEach(m => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${m.Date || ""}</td>
          <td>${m.Time || ""}</td>
          <td>${m.Topic || ""}</td>
          <td>${m.Host || ""}</td>
          <td>
            <button onclick="editMeeting(${m.rowIndex})">‚úèÔ∏è Edit</button>
            <button onclick="deleteMeeting(${m.rowIndex})">üóëÔ∏è Delete</button>
          </td>
        `;
        table.appendChild(row);

        <h3>‚ûï Schedule New Meeting</h3>

<label>Date</label>
<input type="date" id="date">

<label>Time</label>
<input type="time" id="time">

<label>Topic</label>
<input type="text" id="topic" placeholder="e.g., Invocation Rituals">

<label>Host</label>
<input type="text" id="host" placeholder="e.g., Swami Vinayananda">

<button onclick="submitMeeting()">üìß Schedule & Send Email</button>

<div id="status"></div>
      });
    }

    function editMeeting(rowIndex) {
      alert("Edit meeting at row " + rowIndex);
    }

    function deleteMeeting(rowIndex) {
      alert("Delete meeting at row " + rowIndex);
    }

    window.onload = google.script.run.withSuccessHandler(function(response) {
  document.getElementById("status").innerText = response;
}).sendMeetingEmail(meetingData);function() {
      google.script.run.withSuccessHandler(renderMeetings).getAllMeetings();
    };
  </script>
</head>
<body>
  <h2>üîÆ Admin Meeting Chamber</h2>
  <table id="meetingTable"></table>
</body>
</html>
